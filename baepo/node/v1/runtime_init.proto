syntax = "proto3";

package baepo.node.v1;

import "google/protobuf/empty.proto";
import "google/protobuf/timestamp.proto";
import "baepo/core/v1/container.proto";

option go_package = "github.com/baepo-cloud/baepo-proto/go/baepo/node/v1;nodev1pb";

service RuntimeInit {
  rpc WriteLog(stream RuntimeInitWriteLogRequest) returns (stream google.protobuf.Empty);

  rpc UpdateContainerState(RuntimeInitUpdateContainerStateRequest) returns (google.protobuf.Empty);
}

message RuntimeInitWriteLogRequest {
  string container_id = 1;
  string container_name = 2;
  bool error = 3;
  bytes content = 4;
  google.protobuf.Timestamp timestamp = 5;
}

message RuntimeInitUpdateContainerStateRequest {
  string container_id = 1;
  baepo.core.v1.ContainerState state = 2;
  optional google.protobuf.Timestamp started_at = 3;
  optional google.protobuf.Timestamp exited_at = 4;
  optional int32 exit_code = 5;
  optional string exit_error = 6;
  bool healthy = 7;
  optional string healthcheck_error = 8;
  int32 restart_count = 9;
}
